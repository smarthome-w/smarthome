rule "scene_rule"
when
    Member of gScenes received update
then
  try {
    if (GF_Presence_Mode.state.toString() == "PRESENT") {
        logError("scene", "scene: {}", triggeringItem.name)
        var int logLevel = 6
        if (HH_DebugLevel_Scene.state !== NULL) {
          logLevel = (HH_DebugLevel_Scene.state as Number).intValue
        }

        var int bedroomBlindLevel = 0
        if (HH_Night_Bedroom_Blind_Level.state !== NULL) {
            bedroomBlindLevel = logLevel = (HH_Night_Bedroom_Blind_Level.state as Number).intValue
        }

        if (triggeringItem.name == "GH_Day_Scene"){
//            if (logLevel >= 6) {
              logError("scene_rule", "day")
//            }
            GF_FamilyRoom_Rollershutter_AutoUp.sendCommand(ON)
        }
        if (triggeringItem.name == "GH_Evening_Scene"){
//            if (logLevel >= 6) {
              logError("scene_rule", "evening")
//            }
            GF_FamilyRoom_Scenario.sendCommand(ON)
            GF_FamilyRoom_Rollershutter_AutoDown.sendCommand(ON)
            FF_Bedroom_Rollershutter_AutoDown.sendCommand(ON)
        }
        if (triggeringItem.name == "GH_Night_Scene"){
//            if (logLevel >= 6) {
              logError("scene_rule", "night")
//            }
            GF_FamilyRoom_Rollershutter_AutoDown.sendCommand(ON)
//            FF_Bedroom_Rollershutter_AutoDown.sendCommand(ON)
            GF_Lights_Scenario.sendCommand(OFF)
            RTV_TV_TV.sendCommand(OFF)
            FF_Bedroom_Lights.sendCommand(ON)
        }

        if (triggeringItem.name == "GH_Bedroom_Night_Scene"){
            logError("scene", "bedroom night")
//            if (logLevel >= 6) {
              logError("scene_rule", "FF_Bedroom_Lights to OFF")
//            }
            FF_Bedroom_Lights.sendCommand(OFF)
//            if (logLevel >= 6) {
              logError("scene_rule", "FF_Bedroom_Rollershutter_Dimmer to {}", bedroomBlindLevel)
//            }
            FF_Bedroom_Rollershutter_Dimmer.sendCommand(bedroomBlindLevel.intValue)
        }

        if (triggeringItem.name == "GH_BrightWindow_Scene"){
//            if (logLevel >= 6) {
            logError("scene", "bright window")
//            }
            GF_FamilyRoom_Rollershutter_AutoUp.sendCommand(ON)
        }
        if (triggeringItem.name == "GH_DarkWindow_Scene"){
//            if (logLevel >= 6) {
            logError("scene", "dark window")
//            }
            GF_FamilyRoom_Rollershutter_AutoDown.sendCommand(ON)
        }
    }
  } catch (Throwable t) {
    logError("Error", "Error in scene_rule {} {} {}", triggeringItem.name, triggeringItem.state, t.toString)
  } finally {
  }
end
